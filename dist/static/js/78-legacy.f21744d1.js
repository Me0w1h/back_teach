"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[78],{5078:function(a,t,e){e.r(t),e.d(t,{default:function(){return h}});var l=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("br"),e("el-row",[e("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){a.ExamlogVisible=!0}}},[a._v("新增考试")])],1),e("br"),e("el-divider"),e("el-table",{staticStyle:{width:"100%"},attrs:{data:a.tableData.filter((function(t){return!a.search||t.name.toLowerCase().includes(a.search.toLowerCase())})),"max-height":"400"}},[e("el-table-column",{attrs:{label:"序号",type:"index"}}),e("el-table-column",{attrs:{label:"名称",prop:"examName","header-align":"center",align:"center"}}),e("el-table-column",{attrs:{label:"日期",prop:"date","header-align":"center",align:"center"}}),e("el-table-column",{attrs:{label:"状态",prop:"status","header-align":"center",align:"center"}}),e("el-table-column",{attrs:{align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return a.selectClearData(t.row)}}},[a._v("考试详情")]),e("el-button",{attrs:{size:"mini"},on:{click:function(e){a.addClassVisible=!0,a.getClassData(t.row)}}},[a._v("添加班级")])]}}])},[e("template",{slot:"header"},[e("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:a.search,callback:function(t){a.search=t},expression:"search"}})],1)],2)],1),e("el-dialog",{attrs:{title:"新增考试",visible:a.ExamlogVisible,width:"18%"},on:{"update:visible":function(t){a.ExamlogVisible=t}}},[e("el-form",{ref:"form",staticStyle:{"text-align":"center"},attrs:{model:a.addExam,"label-width":"40px"}},[e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{model:{value:a.addExam.examName,callback:function(t){a.$set(a.addExam,"examName",t)},expression:"addExam.examName"}})],1),e("el-form-item",{attrs:{label:"描述"}},[e("el-input",{attrs:{placeholder:"请输入内容"},model:{value:a.addExam.description,callback:function(t){a.$set(a.addExam,"description",t)},expression:"addExam.description"}})],1),e("el-form",[e("div",{staticClass:"block"},[e("span",{staticClass:"demonstration"},[a._v("日期")]),e("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:a.addExam.date,callback:function(t){a.$set(a.addExam,"date",t)},expression:"addExam.date"}})],1)]),e("el-form-item",{attrs:{label:""}},[e("el-switch",{attrs:{"active-text":"立即开启","inactive-text":"稍后开启"},model:{value:a.addExam.status,callback:function(t){a.$set(a.addExam,"status",t)},expression:"addExam.status"}})],1),e("el-button",{attrs:{type:"primary"},on:{click:a.handleaddExam}},[a._v("提交")]),e("el-button",{on:{click:function(t){a.ExamlogVisible=!1}}},[a._v("取消")])],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),[e("el-divider"),e("el-table",{staticStyle:{width:"100%"},attrs:{data:a.clearData,"max-height":"300"}},[e("el-table-column",{attrs:{label:"序号",type:"index"}}),e("el-table-column",{attrs:{prop:"className",label:"班级名称",width:"180"}}),e("el-table-column",{attrs:{prop:"count",label:"已填写人数"}}),e("el-table-column",{attrs:{prop:"score",label:"分数"}}),e("el-table-column",{attrs:{prop:"total",label:"总人数"}})],1)],e("el-dialog",{attrs:{title:"新增班级",visible:a.addClassVisible,width:"18%"},on:{"update:visible":function(t){a.addClassVisible=t}}},[e("el-cascader",{ref:"cascader",attrs:{placeholder:"试试搜索：班级",options:a.classData,props:{multiple:!0},filterable:""},on:{change:a.changeSelectArr}}),e("el-button",{attrs:{type:"primary"},on:{click:function(t){return a.addClassExam()}}},[a._v("提交")]),e("el-button",{on:{click:function(t){a.addClassVisible=!1,a.cancelClassExam(a.val)}}},[a._v("取消")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1)],2)},s=[],i=(e(2526),e(1817),e(5063)),r=e.n(i);e(5437);r().defaults.withCredentials=!0;var c="124.222.86.127",n=":54321",d={name:"Exam",data:function(){return{tableData:{id:"",examName:"",date:"",status:""},ExamlogVisible:!1,addExam:{examName:"",description:"",date:"",status:""},search:"",clearData:[{examName:"",classId:"",className:"",count:"",score:"",total:""}],addClass:{classId:"",classNmae:"",school:""},addClassVisible:!1,classData:[],selectArrs:[]}},mounted:function(){this.selectAll(),this.testlogin()},methods:{sleep:function(a){var t=(new Date).getTime();while(1)if((new Date).getTime()-t>a)break},testlogin:function(){var a=this;r().get("http://"+c+n+"/admin").then((function(t){20001==t.data.code||2e4==t.data.code&&(a.$message.error("请先登录!!!"),a.sleep(1e3),location.href="http://"+c+":8888/#/login")}))},selectAll:function(){var a=this;r().get("http://"+c+n+"/exams").then((function(t){a.tableData=t.data.data}))},handleaddExam:function(){var a=this;(this.addExam.status=!0)?this.addExam.status=1:this.addExam.status=0,r().post("http://"+c+n+"/exams",this.addExam).then((function(t){a.ExamlogVisible=!1,20011==t.data.code?(a.$message.success("添加成功"),a.selectAll()):20010==t.data.code&&a.$message.error("添加失败"),a.addExam.examName="",a.addExam.description="",a.addExam.date="",a.addExam.status=""}))},selectClearData:function(a){var t=this;r().get("http://"+c+n+"/texam/"+a.id).then((function(a){t.clearData=a.data.data;for(var e=0;e<t.clearData.length;e++){var l=t.clearData[e];l.count<l.total&&(l.score="未统计完成")}}))},getClassData:function(a){var t=this;this.classData=[];var e=0;r().get("http://"+c+n+"/class").then((function(a){for(var l=0;l<a.data.data.length;l++){for(var s=0;s<t.classData.length;s++)a.data.data[l].school===t.classData[s].label&&(t.classData[s].children.push({value:a.data.data[l].classId,disabled:!1,label:a.data.data[l].className}),e+=1);0==e&&t.classData.push({value:l,label:a.data.data[l].school,children:[{value:a.data.data[l].classId,label:a.data.data[l].className}]}),e=0}})),r().get("http://"+c+n+"/texam/"+a.id).then((function(a){for(var e=0;e<a.data.data.length;e++)for(var l=0;l<t.classData.length;l++){for(var s=0,i=0;i<t.classData[l].children.length;i++)if(a.data.data[e].classId==t.classData[l].children[i].value){t.classData[l].children[i].disabled=!0,s+=1;break}if(1==s)break}})),this.selectArrs=[],this.selectArrs.push(a.id)},changeSelectArr:function(a){var t=this.$refs["cascader"].getCheckedNodes(),e=[];for(var l in e.push(this.selectArrs[0]),t)t[l]["data"].children||e.push(t[l]["data"].value);this.selectArrs=e},addClassExam:function(){var a=this;r().post("http://"+c+n+"/texam/",this.selectArrs).then((function(t){20011==t.data.code?(a.$message.success("添加成功"),a.selectAll()):20010==t.data.code&&a.$message.error("添加失败")})),this.addClassVisible=!1},cancelClassExam:function(){console.log(this.$refs["cascader"]),this.$refs["cascader"].panel.clearCheckedNodes()}}},o=d,u=e(1001),m=(0,u.Z)(o,l,s,!1,null,null,null),h=m.exports}}]);
//# sourceMappingURL=78-legacy.f21744d1.js.map