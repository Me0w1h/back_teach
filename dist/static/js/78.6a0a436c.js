"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[78],{5078:function(a,t,e){e.r(t),e.d(t,{default:function(){return u}});var l=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("br"),e("el-row",[e("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){a.ExamlogVisible=!0}}},[a._v("新增考试")])],1),e("br"),e("el-divider"),e("el-table",{staticStyle:{width:"100%"},attrs:{data:a.tableData.filter((function(t){return!a.search||t.name.toLowerCase().includes(a.search.toLowerCase())})),"max-height":"400"}},[e("el-table-column",{attrs:{label:"序号",type:"index"}}),e("el-table-column",{attrs:{label:"名称",prop:"examName","header-align":"center",align:"center"}}),e("el-table-column",{attrs:{label:"日期",prop:"date","header-align":"center",align:"center"}}),e("el-table-column",{attrs:{label:"状态",prop:"status","header-align":"center",align:"center"}}),e("el-table-column",{attrs:{align:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return a.selectClearData(t.row)}}},[a._v("考试详情")]),e("el-button",{attrs:{size:"mini"},on:{click:function(e){a.addClassVisible=!0,a.getClassData(t.row)}}},[a._v("添加班级")])]}}])},[e("template",{slot:"header"},[e("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:a.search,callback:function(t){a.search=t},expression:"search"}})],1)],2)],1),e("el-dialog",{attrs:{title:"新增考试",visible:a.ExamlogVisible,width:"18%"},on:{"update:visible":function(t){a.ExamlogVisible=t}}},[e("el-form",{ref:"form",staticStyle:{"text-align":"center"},attrs:{model:a.addExam,"label-width":"40px"}},[e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{model:{value:a.addExam.examName,callback:function(t){a.$set(a.addExam,"examName",t)},expression:"addExam.examName"}})],1),e("el-form-item",{attrs:{label:"描述"}},[e("el-input",{attrs:{placeholder:"请输入内容"},model:{value:a.addExam.description,callback:function(t){a.$set(a.addExam,"description",t)},expression:"addExam.description"}})],1),e("el-form",[e("div",{staticClass:"block"},[e("span",{staticClass:"demonstration"},[a._v("日期")]),e("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:a.addExam.date,callback:function(t){a.$set(a.addExam,"date",t)},expression:"addExam.date"}})],1)]),e("el-form-item",{attrs:{label:""}},[e("el-switch",{attrs:{"active-text":"立即开启","inactive-text":"稍后开启"},model:{value:a.addExam.status,callback:function(t){a.$set(a.addExam,"status",t)},expression:"addExam.status"}})],1),e("el-button",{attrs:{type:"primary"},on:{click:a.handleaddExam}},[a._v("提交")]),e("el-button",{on:{click:function(t){a.ExamlogVisible=!1}}},[a._v("取消")])],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),[e("el-divider"),e("el-table",{staticStyle:{width:"100%"},attrs:{data:a.clearData,"max-height":"300"}},[e("el-table-column",{attrs:{label:"序号",type:"index"}}),e("el-table-column",{attrs:{prop:"className",label:"班级名称",width:"180"}}),e("el-table-column",{attrs:{prop:"count",label:"已填写人数"}}),e("el-table-column",{attrs:{prop:"score",label:"分数"}}),e("el-table-column",{attrs:{prop:"total",label:"总人数"}})],1)],e("el-dialog",{attrs:{title:"新增班级",visible:a.addClassVisible,width:"18%"},on:{"update:visible":function(t){a.addClassVisible=t}}},[e("el-cascader",{ref:"cascader",attrs:{placeholder:"试试搜索：班级",options:a.classData,props:{multiple:!0},filterable:""},on:{change:a.changeSelectArr}}),e("el-button",{attrs:{type:"primary"},on:{click:function(t){return a.addClassExam()}}},[a._v("提交")]),e("el-button",{on:{click:function(t){a.addClassVisible=!1,a.cancelClassExam(a.val)}}},[a._v("取消")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1)],2)},s=[],i=e(5063),d=e.n(i);e(5437);d().defaults.withCredentials=!0;const r="124.222.86.127",c=":54321";var o={name:"Exam",data(){return{tableData:{id:"",examName:"",date:"",status:""},ExamlogVisible:!1,addExam:{examName:"",description:"",date:"",status:""},search:"",clearData:[{examName:"",classId:"",className:"",count:"",score:"",total:""}],addClass:{classId:"",classNmae:"",school:""},addClassVisible:!1,classData:[],selectArrs:[]}},mounted(){this.selectAll(),this.testlogin()},methods:{sleep(a){var t=(new Date).getTime();while(1)if((new Date).getTime()-t>a)break},testlogin(){d().get("http://"+r+c+"/admin").then((a=>{20001==a.data.code||2e4==a.data.code&&(this.$message.error("请先登录!!!"),this.sleep(1e3),location.href="http://"+r+":8888/#/login")}))},selectAll(){d().get("http://"+r+c+"/exams").then((a=>{this.tableData=a.data.data}))},handleaddExam(){(this.addExam.status=!0)?this.addExam.status=1:this.addExam.status=0,d().post("http://"+r+c+"/exams",this.addExam).then((a=>{this.ExamlogVisible=!1,20011==a.data.code?(this.$message.success("添加成功"),this.selectAll()):20010==a.data.code&&this.$message.error("添加失败"),this.addExam.examName="",this.addExam.description="",this.addExam.date="",this.addExam.status=""}))},selectClearData(a){d().get("http://"+r+c+"/texam/"+a.id).then((a=>{this.clearData=a.data.data;for(let t=0;t<this.clearData.length;t++){const a=this.clearData[t];a.count<a.total&&(a.score="未统计完成")}}))},getClassData(a){this.classData=[];let t=0;d().get("http://"+r+c+"/class").then((a=>{for(let e=0;e<a.data.data.length;e++){for(let l=0;l<this.classData.length;l++)a.data.data[e].school===this.classData[l].label&&(this.classData[l].children.push({value:a.data.data[e].classId,disabled:!1,label:a.data.data[e].className}),t+=1);0==t&&this.classData.push({value:e,label:a.data.data[e].school,children:[{value:a.data.data[e].classId,label:a.data.data[e].className}]}),t=0}})),d().get("http://"+r+c+"/texam/"+a.id).then((a=>{for(let t=0;t<a.data.data.length;t++)for(let e=0;e<this.classData.length;e++){let l=0;for(let s=0;s<this.classData[e].children.length;s++)if(a.data.data[t].classId==this.classData[e].children[s].value){this.classData[e].children[s].disabled=!0,l+=1;break}if(1==l)break}})),this.selectArrs=[],this.selectArrs.push(a.id)},changeSelectArr(a){let t=this.$refs["cascader"].getCheckedNodes(),e=[];e.push(this.selectArrs[0]);for(let l in t)t[l]["data"].children||e.push(t[l]["data"].value);this.selectArrs=e},addClassExam(){d().post("http://"+r+c+"/texam/",this.selectArrs).then((a=>{20011==a.data.code?(this.$message.success("添加成功"),this.selectAll()):20010==a.data.code&&this.$message.error("添加失败")})),this.addClassVisible=!1},cancelClassExam(){console.log(this.$refs["cascader"]),this.$refs["cascader"].panel.clearCheckedNodes()}}},n=o,h=e(1001),m=(0,h.Z)(n,l,s,!1,null,null,null),u=m.exports}}]);
//# sourceMappingURL=78.6a0a436c.js.map