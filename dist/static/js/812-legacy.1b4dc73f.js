"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[812],{1812:function(e,a,s){s.r(a),s.d(a,{default:function(){return h}});var l=function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",[s("br"),s("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchUser}},[s("el-form-item",{attrs:{label:"姓名"}},[s("el-input",{attrs:{placeholder:"姓名"},model:{value:e.searchUser.name,callback:function(a){e.$set(e.searchUser,"name",a)},expression:"searchUser.name"}})],1),s("el-form-item",{attrs:{label:"班级"}},[s("el-input",{attrs:{placeholder:"姓名"},model:{value:e.searchUser.className,callback:function(a){e.$set(e.searchUser,"className",a)},expression:"searchUser.className"}})],1),s("el-form-item",{attrs:{label:"学校"}},[s("el-input",{attrs:{placeholder:"学校"},model:{value:e.searchUser.school,callback:function(a){e.$set(e.searchUser,"school",a)},expression:"searchUser.school"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1),s("el-row",[s("el-button",{attrs:{type:"primary",round:""},on:{click:function(a){e.dialogVisible=!0}}},[e._v("新增用户")]),s("el-button",{attrs:{type:"primary",round:""},on:{click:function(a){e.addClassVisible=!0}}},[e._v("新增班级")]),s("el-button",{attrs:{type:"danger",round:""},on:{click:e.deleteByIds}},[e._v("批量删除")])],1),s("el-dialog",{attrs:{title:"新增用户",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(a){e.dialogVisible=a}}},[s("el-form",{ref:"form",attrs:{model:e.addUser,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"姓名"}},[s("el-input",{model:{value:e.addUser.name,callback:function(a){e.$set(e.addUser,"name",a)},expression:"addUser.name"}})],1),s("el-form-item",{attrs:{label:"学号"}},[s("el-input",{model:{value:e.addUser.username,callback:function(a){e.$set(e.addUser,"username",a)},expression:"addUser.username"}})],1),s("el-form-item",{attrs:{label:"班级"}},[s("el-select",{attrs:{placeholder:"班级"},model:{value:e.addUser.classId,callback:function(a){e.$set(e.addUser,"classId",a)},expression:"addUser.classId"}},e._l(e.classNames,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("el-form-item",{attrs:{label:"学校"}},[s("el-select",{attrs:{placeholder:"班级"},model:{value:e.addUser.school,callback:function(a){e.$set(e.addUser,"school",a)},expression:"addUser.school"}},e._l(e.schools,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.addaUser}},[e._v("提交")]),s("el-button",{on:{click:function(a){e.dialogVisible=!1}}},[e._v("取消")])],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),s("el-dialog",{attrs:{title:"新增班级",visible:e.addClassVisible,width:"25%"},on:{"update:visible":function(a){e.addClassVisible=a}}},[s("el-form",{ref:"form",attrs:{model:e.addClassData,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"序号"}},[s("el-input",{attrs:{maxlength:10},model:{value:e.addClassData.classId,callback:function(a){e.$set(e.addClassData,"classId",a)},expression:"addClassData.classId"}})],1),s("el-form-item",{attrs:{label:"班级"}},[s("el-input",{model:{value:e.addClassData.className,callback:function(a){e.$set(e.addClassData,"className",a)},expression:"addClassData.className"}})],1),s("el-form-item",{attrs:{label:"学校"}},[s("el-select",{attrs:{placeholder:""},model:{value:e.addClassData.school,callback:function(a){e.$set(e.addClassData,"school",a)},expression:"addClassData.school"}},e._l(e.schools,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.addClass}},[e._v("提交")]),s("el-button",{on:{click:function(a){e.addClassVisible=!1}}},[e._v("取消")])],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.alluser,"row-class-name":e.tableRowClassName},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),s("el-table-column",{attrs:{type:"index",width:"50"}}),s("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180",align:"center"}}),s("el-table-column",{attrs:{prop:"className",label:"班级",width:"180",align:"center"}}),s("el-table-column",{attrs:{prop:"school",label:"所属学校",align:"center"}}),s("el-table-column",{attrs:{prop:"id",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(s){return e.updateById(a.row)}}},[e._v("修改")]),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(s){return e.deleteById(a.row)}}},[e._v("删除")])]}}])})],1)],s("el-dialog",{attrs:{title:"修改用户信息",visible:e.dialogVisible2,width:"30%"},on:{"update:visible":function(a){e.dialogVisible2=a}}},[s("el-form",{ref:"form",attrs:{model:e.addUser,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"姓名"}},[s("el-input",{model:{value:e.addUser.name,callback:function(a){e.$set(e.addUser,"name",a)},expression:"addUser.name"}})],1),s("el-form-item",{attrs:{label:"学号"}},[s("el-input",{model:{value:e.addUser.username,callback:function(a){e.$set(e.addUser,"username",a)},expression:"addUser.username"}})],1),s("el-form-item",{attrs:{label:"班级"}},[s("el-select",{attrs:{placeholder:"班级"},model:{value:e.addUser.classId,callback:function(a){e.$set(e.addUser,"classId",a)},expression:"addUser.classId"}},e._l(e.classNames,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("el-form-item",{attrs:{label:"学校"}},[s("el-select",{attrs:{placeholder:"班级"},model:{value:e.addUser.school,callback:function(a){e.$set(e.addUser,"school",a)},expression:"addUser.school"}},e._l(e.schools,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.addaUser}},[e._v("提交")]),s("el-button",{on:{click:function(a){e.dialogVisible2=!1}}},[e._v("取消")])],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),s("el-pagination",{attrs:{total:e.totalCount,"current-page":e.currentPage,"page-sizes":[5,10],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],2)},t=[],o=(s(9653),s(8309),s(5063)),r=s.n(o);r().defaults.withCredentials=!0;var d="124.222.86.127",i=":54321",n={name:"user",data:function(){return{updateUser:{id:"",name:"",username:"",classId:"",className:"",school:""},totalCount:100,selectIds:[],currentPage:1,pageSize:10,dialogVisible:!1,dialogVisible2:!1,alluser:{id:"",username:"",password:"",name:"",className:"",classId:"",school:""},addUser:{id:"",username:"",name:"",classId:"",className:"",school:""},addClassVisible:!1,addClassData:{classId:"",className:"",school:""},searchUser:{name:"",className:"",school:""},classNames:[],schools:[],multipleSelection:[],deleteIds:[]}},mounted:function(){this.testlogin(),this.selectAll(),this.getClasses()},methods:{sleep:function(e){var a=(new Date).getTime();while(1)if((new Date).getTime()-a>e)break},testlogin:function(){var e=this;r().get("http://"+d+i+"/admin").then((function(a){20001==a.data.code||2e4==a.data.code&&(e.$message.error("请先登录!!!"),e.sleep(1e3),location.href="http://"+d+":8888/#/login")}))},getClasses:function(){var e=this;r().get("http://+"+d+i+"+/class").then((function(a){for(var s=0;s<a.data.data.length;s++)if(e.classNames.push({label:a.data.data[s].className,value:a.data.data[s].classId}),s>0)for(var l=0;l<e.schools.length;l++){if(a.data.data[s].school==e.schools[l].label)break;l==e.schools.length-1&&e.schools.push({label:a.data.data[s].school,value:a.data.data[s].school})}else e.schools.push({label:a.data.data[s].school,value:a.data.data[s].school})}))},selectAll:function(){var e=this;r().post("http://"+d+i+"/user/?currentPage="+this.currentPage+"&size="+this.pageSize,this.searchUser).then((function(a){e.alluser=a.data.data.rows,e.totalCount=Number(a.data.data.totalCount)}))},onSubmit:function(){this.selectAll()},handleSizeChange:function(e){this.pageSize=e,this.selectAll()},handleCurrentChange:function(e){this.currentPage=e,this.selectAll()},addaUser:function(){for(var e=this,a=0;a<this.classNames.length;a++){var s=this.classNames[a].value;s===this.addUser.classId&&(this.addUser.className=this.classNames[a].label)}r().post("http://"+d+i+"/user/1",this.addUser).then((function(a){e.dialogVisible=!1,e.addUser.id="",e.addUser.name="",e.addUser.username="",e.addUser.className="",e.addUser.classId="",e.addUser.school="",e.addUser.exam="",20011===a.data.code?(e.$message.success("添加成功"),e.selectAll()):20010===a.data.code?e.$message.error("添加失败"):20031===a.data.code?(e.$message.success("修改成功"),e.selectAll()):20030===a.data.code&&e.$message.error("修改失败")}))},updateById:function(e){this.addUser.id=e.id,this.addUser.name=e.name,this.addUser.classId=e.classId,this.addUser.username=e.username,this.addUser.className=e.className,this.addUser.school=e.school,this.addUser.exam=e.exam,this.dialogVisible2=!0},deleteById:function(e){this.deleteIds[0]=e.id,this.deleteuser()},deleteuser:function(){var e=this;r()["delete"]("http://"+d+i+"/user/",{data:this.deleteIds}).then((function(a){20021===a.data.code?(e.$message.success("删除成功"),e.selectAll()):e.$message.error("删除失败")})),this.deleteIds=[],this.selectAll()},handleSelectionChange:function(e){this.multipleSelection=e},deleteByIds:function(){if(this.multipleSelection.length>0){for(var e=0;e<this.multipleSelection.length;e++)this.deleteIds[e]=this.multipleSelection[e].id;this.deleteuser()}else this.$message.error("请选择数据");this.deleteIds=[]},addClass:function(){var e=this;r().post("http://"+d+i+"/class",this.addClassData).then((function(a){e.addClassVisible=!1,e.addClassData.className="",e.addClassData.classId="",e.addClassData.school="",20011===a.data.code?e.$message.success("添加成功"):20010===a.data.code?e.$message.error("添加失败"):20031===a.data.code?e.$message.success("修改成功"):20030===a.data.code&&e.$message.error("修改失败")}))}}},c=n,u=s(1001),m=(0,u.Z)(c,l,t,!1,null,null,null),h=m.exports}}]);
//# sourceMappingURL=812-legacy.1b4dc73f.js.map